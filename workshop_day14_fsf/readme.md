Uses promises instead of callbacks to pass code to controllers from services
